print( f2 )
f1 <- rankMatrix(PX1)[1]
f2 <- rankMatrix(PX2)[1]
###p6###
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- rankMatrix(PX2)[1]
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- rankMatrix(PX2)[1]
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- 3
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- rankMatrix(PX2)[1]
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- rankMatrix(PX2)[1]
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- rankMatrix(PX2)[1]
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
PX1
t(PX1) - PX1
PX1 %*% PX1 - PX1
solve( PX1 )
PX1
solve( PX1 )
solve( PX2 )
t( PX2 ) - PX2
PX2%*%PX2 - PX2
rankMatrix( PX2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- 3
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- rankMatrix(PX1)[1]
f2 <- 3
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
f2 <- rankMatrix(PX2)[1]
det( PX1 )
det( PX2 )
R(PX1)
?R
??R
install.packages(matlib)
install.packages("matlib")
library(matlib)
R(PX1)
R(PX2)
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- R(PX1)
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
solve( PX1 )
Solve( t(X)%*%X )
Solve( t(X)%*%X )
X
solve(X )
X
Solve (t(X)%*%X)
Solve(t(X)%*%X)
solve(t(X)%*%X)
Px1
PX1
PX2
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 5000 , mu = u , Sigma = I  )
f1 <- R(PX1)
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
u <- rep( 0 , 8 )
I <- diag( 8 )
Y <-  mvrnorm( n = 50000 , mu = u , Sigma = I  )
f1 <- R(PX1)
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )
Y <-  mvrnorm( n = 10000 , mu = u , Sigma = I  )
f1 <- R(PX1)
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
diag( 2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
Y <-  mvrnorm( n = 5000 , mu = rep( 0 , 8 )  , Sigma = diag( 8 ) )
f1 <- R(PX1)
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )
u1 <- u1/f1
u2 <- diag( Y%*%PX2%*%t(Y) )
u2 <- u2/f2
f <- u2 * ( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(20)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
Y <-  mvrnorm( n = 5000 , mu = rep( 0 , 8 )  , Sigma = diag( 8 ) )
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )/R(PX1)
u2 <- diag( Y%*%PX2%*%t(Y) )/R(PX2)
f <- u2*( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
###p6###
set.seed(100)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
Y <-  mvrnorm( n = 5000 , mu = rep( 0 , 8 )  , Sigma = diag( 8 ) )
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )/R(PX1)
u2 <- diag( Y%*%PX2%*%t(Y) )/R(PX2)
f <- u2*( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
set.seed(100)
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
Y <-  mvrnorm( n = 5000 , mu = rep( 0 , 8 )  , Sigma = diag( 8 ) )
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )/R(PX1)
u2 <- diag( Y%*%PX2%*%t(Y) )/R(PX2)
f <- u2*( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
Y <-  mvrnorm( n = 5000 , mu = rep( 0 , 8 )  , Sigma = diag( 8 ) )
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )/R(PX1)
u2 <- diag( Y%*%PX2%*%t(Y) )/R(PX2)
f <- u2*( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
Y <-  mvrnorm( n = 5000 , mu = rep( 0 , 8 )  , Sigma = diag( 8 ) )
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )/R(PX1)
u2 <- diag( Y%*%PX2%*%t(Y) )/R(PX2)
f <- u2*( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
X <- matrix( round( runif( 40 , 0 , 100)) , nrow = 8 , ncol = 5 )
PX1 <- X %*% solve( t(X)%*%X ) %*% t(X)
PX2 <- diag(8) - PX1
Y <-  mvrnorm( n = 5000 , mu = rep( 0 , 8 )  , Sigma = diag( 8 ) )
f2 <- R(PX2)
u1 <- diag( Y%*%PX1%*%t(Y) )/R(PX1)
u2 <- diag( Y%*%PX2%*%t(Y) )/R(PX2)
f <- u2*( u1^(-1) )
hist( f )
d1 <- 3
d2 <- 5
tmean <- d2/( d2 -2 )
tvar <- ( 2 * (d2^2) * ( d1 + d2 - 2 ))/( d1* (d2-2)^2 * (d2 - 4))
amean <- mean( f )
avar <- sd(f)^2
print( amean )
print( tmean )
print( avar )
print( tvar )
print(((amean - tmean)/tmean)*100)
print(((avar-tvar)/tvar)*100)
print( f2 )
